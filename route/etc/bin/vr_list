#!/bin/ksh
# $Id: vr_list,v 1.2 2002/04/30 18:25:46 anand Exp $

# I/VDS
#
# File:	$HOME/bin/vr_list
#
# Description:  Create a list of files modified since the last release.
#
# Dependencies: PCM_CLNT or PCM_SRVR
#
# History:
#	MM/DD/YY	AUTHOR		DESCRIPTION
#	06/02/94	TRD		Initial creation.
#	07/21/94	TRD		Added more descriptive comments.
#	07/26/94	TRD		Added "grep" line to retrieve filenames
#					of newly created project files.
#	09/22/94	TRD		Changed name from rt_list to more 
#					closely match other scripts.
 
# Determine version for retrieval
# echo "Create list of files modified since last revision?"
# echo " "
# echo "Enter last version [xx.xx.xx.xx]: "
# read vers 
# echo " "

# Determine date for retrieval
# echo "Current date [dd-Mmm-yy]: "
echo "Create list of files Modified Since Date"
echo " "
echo "Enter date [dd-Mmm-yy]: "
read sdate
echo " "
     if  [ -r  "$HOME/rhistory/hist_log/log$sdate" ] 
     then
	    echo "Log file with date $sdate already exists."
	    echo "Press <c> to continue or any key to exit."
	    read cans
	    case "$cans" in

		'c') echo "Overwriting log$sdate"
		     break;;
		 * ) exit
		     break;;
	    esac
     else 
           echo $sdate
     fi

# create pinnacle history file
pinnacle -n "connect r240_int.r240@atlantis.b17c.ingr.com;
set proj route240;
show history -since $sdate > log$sdate;
show error" > $logfile

# show history -since r:$vers > log$sdate;


# create file to contain list of modified files
LIST=~/rhistory/list

# append modified filenames into LIST file
echo "I/ROUTE Files Modified:\n" > $LIST
grep "Updated" log$sdate | cut -d" " -f4,5,6 >> $LIST 
grep "Replaced" log$sdate | cut -d" " -f4,5,6 >> $LIST 

# append added filenames
echo "\nI/ROUTE Files Added:\n" >> $LIST
grep "Created" log$sdate | cut -d" " -f5,6,7 >> $LIST

# append deleted filenames
echo "\nI/ROUTE Files Deleted:\n" >> $LIST
grep "Deleted" log$sdate | cut -d" " -f4,5,6 >> $LIST

# move dated project history into history log
mv log$sdate ~/rhistory/hist_log/log$sdate

