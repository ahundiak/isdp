all: \
	binaries \
	objects
	
binaries: \
	target_directories \
	_OPP

#	_OPL

objects: \
	target_directories \
	_SPEC \
  	_IGRDIR \
 	_SRC \
	_TEST

target_directories:
	@if not exist $(TARGET)\om\IGRdir mkdir $(TARGET)\om\IGRdir
	@if not exist $(TARGET)\om\opl mkdir $(TARGET)\om\opl
	@if not exist $(TARGET)\om\opp mkdir $(TARGET)\om\opp
	@if not exist $(TARGET)\om\recluster mkdir $(TARGET)\om\recluster
	@if not exist $(TARGET)\om\spec mkdir $(TARGET)\om\spec
	@if not exist $(TARGET)\om\src mkdir $(TARGET)\om\src
	@if not exist $(TARGET)\om\test mkdir $(TARGET)\om\test
	@if not exist $(TARGET)\om\tools mkdir $(TARGET)\om\tools

_OPP:
	@$(ECHO) "\\n\\tMaking opp ..."
	@cd $(TARGET)\om\opp
	@cd
	@$(MAKE)

_OPL: $(TARGET)\om\opl\makefile
	@$(ECHO) "\\n\\tMaking opl ..."
	@cd $(TARGET)\om\opl
	@cd
	@$(MAKE)

$(TARGET)\om\opl\makefile: $(EXNUC)\om\opl\opl.m
	cd $(EXNUC)\om\opl
	$(MAKEMAKE) opl.m $(TARGET)\om\opl\makefile

_TOOLS: $(TARGET)\om\tools\makefile
	@$(ECHO) "\\n\\tMaking tools ..."
	@cd $(TARGET)\om\tools
	@cd
	@$(MAKE)

$(TARGET)\om\tools\makefile: $(EXNUC)\om\tools\tools.m
	cd $(EXNUC)\om\tools
	$(MAKEMAKE) tools.m $(TARGET)\om\tools\makefile

_AUTORECLUSTER: $(TARGET)\om\recluster\makefile
	@$(ECHO) "\\n\\tMaking autorecluster ..."
	@cd $(TARGET)\om\recluster
	@cd
	@$(MAKE) $(TARGET)\bin\autorecluster

$(TARGET)\om\recluster\makefile: $(EXNUC)\om\recluster\recluster.m
	cd $(EXNUC)\om\recluster
	$(MAKEMAKE) recluster.m $(TARGET)\om\recluster\makefile

_COPYOS: $(TARGET)\om\tools\copyOS.mk
	@$(ECHO) "\\n\\tMaking copyOS ..."
	@cd $(TARGET)\om\tools
	@cd
	@$(MAKE) -f copyOS.mk

$(TARGET)\om\tools\copyOS.mk: $(EXNUC)\om\tools\copyOS.m
	cd $(EXNUC)\om\tools
	$(MAKEMAKE) copyOS.m $(TARGET)\om\tools\copyOS.mk

_SPEC: $(TARGET)\om\spec\makefile
	@$(ECHO) "\\n\\tMaking spec ..."
	@cd $(TARGET)\om\spec
	@cd
	@$(MAKE)

$(TARGET)\om\spec\makefile: $(EXNUC)\om\spec\spec.m
	cd $(EXNUC)\om\spec
	$(MAKEMAKE) spec.m $(TARGET)\om\spec\makefile

_SRC: $(TARGET)\om\src\makefile
	@$(ECHO) "\\n\\tMaking src ..."
	@cd $(TARGET)\om\src
	@cd
	@$(MAKE)

$(TARGET)\om\src\makefile: $(EXNUC)\om\src\src.m
	cd $(EXNUC)\om\src
	$(MAKEMAKE) src.m $(TARGET)\om\src\makefile

_IGRDIR: 
	@$(ECHO) "\\n\\tMaking IGRdir ..."
	@cd $(TARGET)\om\IGRdir
	@cd
	@$(MAKE)

_TEST: $(TARGET)\om\test\makefile
	@$(ECHO) "\\n\\tMaking test ..."
	@cd $(TARGET)\om\test
	@cd
	@$(MAKE)

$(TARGET)\om\test\makefile: $(EXNUC)\om\test\test.m
	cd $(EXNUC)\om\test
	$(MAKEMAKE) test.m $(TARGET)\om\test\makefile
