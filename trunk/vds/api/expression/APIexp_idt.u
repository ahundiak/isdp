/***************************************************************************
 * I/VDS
 *
 * File:        api/expression/APIexp_idt.u
 *
 * Description: Get the Types of the expression tables.
 *
 *
 * Dependencies:
 *
 * History:
 *      MM/DD/YY        AUTHOR          DESCRIPTION
 *      10/27/97        i-india         creation date
 *
 ***************************************************************************/

#include <stdio.h>

#include "cieveryone.h"
#include "cimacros.h"

#include "exdef.h"
#include "exmacros.h"
#include "VDdrwlo.h"
#include "vdtblmacros.h"
 
extern EX_findmod();

extern int printf();
extern malloc();
extern free();

main ()
{
	IGRchar		user_resp[80], *Tabtyp;
  	IGRlong     	status, sts, msg;
	IGRint	   	i, count;
	GRspacenum	cur_os;
 
	ci$get(string = user_resp,
         rc     = sts,
         prompt = "Do you need Local/Db/Both [l/d/b]" );
 
	count=0; Tabtyp=NULL; 
	
	ex$get_cur_mod (osnum = &cur_os);
	if((sts & 1) && (user_resp[0] == 'l' || user_resp[0] == 'L')){
		vd$tblexp_idt (msg     = &msg,
                          osnum   = cur_os,
                          local   = TRUE,
                          dbget   = FALSE,
                          p_count = &count);

		Tabtyp = (char *)malloc(count*VD_CREXP_CHR_TYPE);

		vd$tblexp_idt (msg     = &msg,
                          osnum   = cur_os,
                          local   = TRUE,
                          dbget   = FALSE,
                          p_count = &count,
			  p_typs  = Tabtyp);

	} else if ( user_resp[0] == 'd' || user_resp[0] == 'D'){
		vd$tblexp_idt (msg     = &msg,
                          osnum   = cur_os,
                          local   = FALSE,
                          dbget   = TRUE,
                          p_count = &count);

		Tabtyp = (char *)malloc(count*VD_CREXP_CHR_TYPE);

		vd$tblexp_idt (msg     = &msg,
                          osnum   = cur_os,
                          local   = FALSE,
                          dbget   = TRUE,
                          p_count = &count,
                          p_typs  = Tabtyp);

	} else if ( user_resp[0] == 'b' || user_resp[0] == 'B'){
		vd$tblexp_idt (msg     = &msg,
                          osnum   = cur_os,
                          local   = TRUE,
                          dbget   = TRUE,
                          p_count = &count);

		Tabtyp = (char *)malloc(count*VD_CREXP_CHR_TYPE);

		vd$tblexp_idt (msg     = &msg,
                          osnum   = cur_os,
                          local   = TRUE,
                          dbget   = TRUE,
                          p_count = &count,
                          p_typs  = Tabtyp);
	}

	printf ("count=%d\n", count);
	for (i=0; i< count; i=i+1){
		printf ("Tabtyp[%d]=%s\n", i, &Tabtyp[i*VD_CREXP_CHR_TYPE]);
	}
	if (Tabtyp) free(Tabtyp);
}
