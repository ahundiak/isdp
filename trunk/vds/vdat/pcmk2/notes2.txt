    // Grab the next piece mark from the ris table
    VDat2RisGetNextPcmk(setName,&s_nextPcmk);
    
    // Do it
    VDat2CreatePcmkTree(&setID,&s_domTreeID,&s_ssID,&errCnt);
    sprintf(buf,"Piece Mark Error Count %d",errCnt);
    VDfrmSetStatus(form,10,buf);
    VDat2FormFillPcmkList(form,
			  VDAT_FORM_PCMK_G_PIECES,
			  VDAT_FORM_PCMK_G_NEXT_PCMK,
			  VDAT_FORM_PCMK_B_PROCESS,
			  &s_domTreeID,
			  &s_ssID);


    case FI_EXECUTE:
      VDat2FormSyncPcmkList(form,VDAT_FORM_PCMK_G_PIECES,&s_domTreeID);
      VDat2UpdateStagingTreePcmks(&s_setID,&s_domTreeID,&s_ssID,s_save_ss,NULL);
      s_save_ss = 0;
      break;

    case FI_ACCEPT:
      VDat2FormSyncPcmkList(form,VDAT_FORM_PCMK_G_PIECES,&s_domTreeID);
      VDat2UpdateStagingTreePcmks(&s_setID,&s_domTreeID,&s_ssID,s_save_ss,NULL);

    case VDAT_FORM_PCMK_B_CLEAR:
      VDat2FormClearPcmkList(&s_domTreeID);
      VDat2FormFillPcmkList(form,
			    VDAT_FORM_PCMK_G_PIECES,
			    VDAT_FORM_PCMK_G_NEXT_PCMK,
			    VDAT_FORM_PCMK_B_PROCESS,
			    &s_domTreeID,
			    &s_ssID);
      break;

    case VDAT_FORM_PCMK_B_PROCESS:

      VDfrmGetgText(form,VDAT_FORM_PCMK_G_NEXT_PCMK,buf);
      next = atoi(buf);
      
      VDfrmGetgText(form,VDAT_FORM_PCMK_B_PROCESS,buf);
      if (*buf == 'G') {
	VDat2FormNotifyGenerate(form,next,&s_domTreeID);
	VDat2FormFillPcmkList(form,
			      VDAT_FORM_PCMK_G_PIECES,
			      VDAT_FORM_PCMK_G_NEXT_PCMK,
			      VDAT_FORM_PCMK_B_PROCESS,
			      &s_domTreeID,
			      &s_ssID);
      }
      else {
	VDat2FormNotifyVerify(form,next,&s_domTreeID,&s_ssID);
	VDat2FormFillPcmkList(form,
			      VDAT_FORM_PCMK_G_PIECES,
			      VDAT_FORM_PCMK_G_NEXT_PCMK,
			      VDAT_FORM_PCMK_B_PROCESS,
			      &s_domTreeID,
			      &s_ssID);
	VDat2ReportChangedPcmks(&s_setID,&s_domTreeID,&s_ssID);
      }
