#This script will retrieve all files checked into ICOM since date entered
#by the build script that calls this script, and creates a cpio file of
#these files which is sent to the calling node.
#
#   $1 = Reference date used to copy out files checked in since this date.
#   $2 = Node to send cpio file back to.
#   $3 = PDM login of users workstation to send cpio file back to.
#   $4 = PDU login of users workstation to send cpio file back to.
#   $5 = PDMNORM login of users workstation to send cpio file back to.
#   $6 = Login on pdmdel where source will be deltaed out to.

#Set Login Variables to what user passed from calling script
PDMLOGIN=$3
PDULOGIN=$4
NORMLOGIN=$5

echo "PDMLOGIN=$PDMLOGIN"
echo "PDULOGIN=$PDULOGIN"
echo "NORMLOGIN=$NORMLOGIN"

ICOM=$6
echo "The pdmdel directory you have chosen is $ICOM."
nodename=$2
echo "nodename=$nodename"

if [ "$PDULOGIN" != "NULL" ]
then 
echo
echo "RETRIEVING PDU SOURCE FROM ICOM..."
echo
rm $ICOM
mkdir $ICOM
echo "Running delta_pdu.sh"
echo ""
/usr/icom/./delta_pdu.sh $1 pdu24 $ICOM $nodename.$PDULOGIN
echo "Finished delta_pdu.sh"
echo ""
fi

if [ "$PDMLOGIN" != "NULL" ]
then 
echo
echo "RETRIEVING PDM SOURCE FROM ICOM..."
echo
rm $ICOM
mkdir $ICOM
echo "Running delta_pdm.sh"
echo ""
/usr/icom/./delta_pdm.sh $1 pdm24 $ICOM $nodename.$PDMLOGIN
echo "Finished delta_pdm.sh"
echo ""
fi

if [ "$NORMLOGIN" != "NULL" ]
then 
echo
echo "RETRIEVING PDMNORM SOURCE FROM ICOM..."
echo
rm $ICOM
mkdir $ICOM
echo "Running del_pdmnorm.sh"
echo ""
/usr/icom/./del_pdmnorm.sh $1 pdmnorm24 $ICOM $nodename.$NORMLOGIN
echo "Finished delta_pdmnorm.sh"
echo ""
fi
echo "Copy source for PDU and PDM complete"
