/*******************************************************************************
*	This PPL command "Set Flow Arrow Scale"	prompts for 3D scale vector and
*	calls the function VRCorrection_VRFlArSc.
*
*-------------------------------------------------------------------------------
*  EXAMPLES:
*  2		= global XYZ scale factor 2 (setflag = -1)
*  2,		= Xscale 2, Y & Z unchanged (setflag = 1)
*  ,3		= Yscale 3, X & Z unchanged
*  ,3,		= Yscale 3, X & Z unchanged
*  ,,4		= Zscale 4, X & Y unchanged
*  4,,5		= Xscale 4, Zscale 5, Y unchanged
*
*-------------------------------------------------------------------------------
*  VRCorrection_VRFlArSc:
*  setflag = -1  Uniform scale for X,Y,Z
*  XYZscale={0.0, 0.0, 0.0} VRCorrection_VRFlArSc ignores those cases
*-------------------------------------------------------------------------------
*  HISTORY
*  Feb 97 KDD	creation
*
*******************************************************************************/
#include <stdio.h>
#include "cieveryone.h"
#include "ciminimum.h"
#include "cievent.h"


extern	int	VRCorrection_VRFlArSc();
extern  char    *strchr(),
		*strtok();

extern	int	strlen(),
		sprintf();

extern  double  atof();
extern		printf();


main()
{
  int		rc,setflag;
  double	XYZscale[3];
  char		response_data[128],
		*s0,
		*s1,
		*s2,
		*s3;


/* Initialize PPL variables */

  XYZscale[0] = XYZscale[1] = XYZscale[2] = 0.0;
  setflag = -1;


  status("");
  message("Set Flow Arrow Scale");

  ci$get(prompt = "Enter X,Y,Z scale factors. To retrieve <return>.",
         string = response_data,
             rc = rc);

  if ( !(rc&1) ) exit;

/* Get 3D scale vector if <RETURN> */
  if (strlen(response_data) == 0) {
	rc = VRCorrection_VRFlArSc ( 0, XYZscale);
	sprintf(response_data,"Flow Arrow Scale %7g, %7g, %7g", 
		XYZscale[0], XYZscale[1], XYZscale[2]);

	status(response_data);
	exit;
  }

  s0 = response_data; 

  if ( (s1 = strchr( s0, ',')) != NULL ) {
	*s1 = '\0';
	s1 = s1 + 1;

        if ( (s2 = strchr( s1 , ',')) != NULL ) {
		*s2 = '\0';
		s2 = s2 + 1;

		s3 = strtok(s2, ","); 

		XYZscale[2] = atof(s2);
	}

	XYZscale[1] = atof(s1);
	setflag = 1;
  }

  XYZscale[0] = atof(s0);

/* This function is to store/set/get the flow arrow scale */

  rc = VRCorrection_VRFlArSc ( setflag, XYZscale);

}



