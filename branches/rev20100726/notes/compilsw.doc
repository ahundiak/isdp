_______________________________________________________________________________

SUBJECT:	Standardization of compilation switches
DATE:		3/93
_______________________________________________________________________________


Introduction
------------

	This document describes a standard for compilation switches to be used
	to build EXNUC based software.  It is hoped to eliminate confusion and
	increase code portability.

Compile switches
----------------

	A number of global #defines are used in source code to allow the same
	source to be compiled for different environments (X, Clipper, Sun etc).
	Some of these were defined in the include file
	"exnuc/include/exsysdep.h" while some of them were set at compile
	time by makefiles.

	The exnuc include file "exsysdep.h" defines either LITTLE_ENDIAN
	or BIG_ENDIAN, depending on the hardware being built upon.


	Hardware based switches (builtin)
	---------------------------------

		The following defines will be set (in exnuc/include/exsysdep.h)
		according to the hardware being compiled upon:

			hardware	define name(s)
			--------	--------------
			clipper		LITTLE_ENDIAN
			mips		LITTLE_ENDIAN
			sparc		BIG_ENDIAN, BIT_FIELDS_REVERSED

		To reference these symbols, #include <exsysdep.h> before
		referencing the required symbol.

		No changes to exsysdep.h were required to support SUNOS5/
		Solaris since there is already an entry for 'sparc'.


	Runtime switches
	----------------

		The following should be set at compile time for acc, omcpp,
		and opp.  Note these are NOT set in exsysdep.h and should
		be set by a makefile or the build environment.  See your
		system integrator for details about how these are set for
		your application layer.

		operating system	define name(s)
		----------------	--------------
		ISS 7.x			CLIX, SYSV, UNIX, SVR3, CLIX7
		IRIX 4.x		IRIX, SYSV, UNIX, SVR3, IRIX4
		IRIX 5.x		IRIX, SYSV, UNIX, SVR4, IRIX5
		SunOS 4.x		SUNOS, BSD, UNIX, SUNOS4
		SunOS 5.x (Solaris)	SUNOS, SYSV, UNIX, SVR4, SUNOS5
		NT			NT

		windowing system*	define name(s)
		----------------	--------------
		Environ 5		ENV5
		X windows (generic)	X11
		X windows release 5.x	X11R5
		Windows-32 (NT)		WIN32
		Open GL			OPENGL

		compiler, opp & omcpp	define name(s)
		---------------------	--------------
		ISS C (ACC), c1&c3	__APGE__
		ISS C (ACC), c4		__APGE__, __cpu_c400__
		IRIX 4.x C		__EXTENSIONS__, __sgi, __unix,
					__host_mips, __SVR3, _MIPSEB,
					_SYSTYPE_SYSV, _LANGUAGE_C
		IRIX 5.x C		__EXTENSIONS__, __sgi, __unix,
					__host_mips, __SVR4, _MIPSEB,
					_SYSTYPE_SYSV, _LANGUAGE_C,
					_MIPS_SZINT=32, _MIPS_SZLONG=32,
					_MIPS_SZPTR=32
		SunOS 4.x C		
		SunOS 5.x C		
		NT C (cl386)		WIN32, NT, _NTWIN, _WINDOWS

		compiler		flags
		--------		--------------
		ISS C (ACC), c1 & c3	-O3 -ansi
		ISS C (ACC), c4		-O3 -ansi -Atarg=c400
		IRIX 4.x C		-O2 -ansi -signed
		IRIX 5.x C		-O2 -ansi -signed
		SunOS 4.x C		-O2 -temp=$TMPDIR
		SunOS 5.x C		-O -Xc		
		NT C (cl386)		-W3 -Zp8 -G3d -Ox -Gs -nologo


		*Note:  The X windows compile switch used to be RUN_X.  It
		 ----   is being replaced by X11.  The symbol X11R5 should
			be used only to bracket code specific to release
			5 of X windows.  It is a superset of X11.

			In addition to a compile switch for each operating
			system, there is now a compile switch for each major
			operating system release, e.g., SUNOS4 and SUNOS5.
			There are also switches now to distinguish between
			System V, Rel 3 (SVR3) and System V, Rel 4 (SVR4);
			these are in addition to the SYSV switch which has
			been in use for some time.			


Use in source code
------------------

	All source code should be changed to use the new global define names
	outlined above.  Wherever possible #ifndef and #else should be replaced
	with #ifdef to eliminate errors.  For example the following:

		#ifndef RUN_X
			/* non X code goes here */
		#else
			/* X code goes here */
		#endif

	Should be changed to:

		#ifdef ENV5
			/* non X code goes here */
		#endif
		#ifdef X11
			/* X code goes here */
		#endif


	Or use #else to generate an error if no switches are set:

		#if defined(ENV5)
			/* non X code goes here */
		#elif defined(X11)
			/* X code goes here */
		#else
		#error Windowing system switches must be set!
		#endif


Future expansion
----------------

	This file is geared for the projects which lie in the current plans
	for EXNUC based developers.  If projects arise in the future which
	need additional switches to be defined, then this document can and
	will be updated to keep pace.  We will also deliver this document
	in the exnuc/notes directory for DPs.
