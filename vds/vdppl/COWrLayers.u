/* $Id */

/* --------------------------------------------------------------------
 * I/VDS
 *
 * File:	vds/vdppl/COWrLayers.u
 *
 * Description: Writes named layers to a text file
 *              The Edit Layers form must be on the screen
 *
 * Dependencies:
 *
 * Revision History:
 *	$Log: COWrLayers.u,v $
 *	Revision 1.1.1.1  2001/01/04 21:09:02  cvs
 *	Initial import to CVS
 *	
# Revision 1.1  1998/07/23  17:32:14  pinnacle
# CR179801234
#
 *
 * History:
 * MM/DD/YY  AUTHOR  DESCRIPTION
 * 07/23/98  ah      CR179801234 Creation
 * -------------------------------------------------------------------*/

#include "ciminimum.h"
#include "cimacros.h"
#include "stdio.h"

extern UI_status();
extern FI_get_form_by_name();
extern FIfld_get_text();

main()
{
  IGRchar *form;
  IGRint  gadget;
  IGRchar name[1024];
  IGRchar layers[1024];
  IGRint  row,sel,pos;
  IGRint  flag;

  FILE *file;
  IGRchar fileName[256];
  
  // Init
  file = NULL;
  *fileName = 0;
  
  // Grab the form
  form = NULL;
  FI_get_form_by_name("GRLayers", &form);
  
  if (form == NULL) {
    UI_status("Please start the 'Edit Layers' command first");
    goto wrapup;
  }

  // Get the file
  ci$get(prompt = "Enter file name",
	 string = fileName);
  if (*fileName == 0) file = stdout;
  else {
    file = fopen(fileName,"wt");
    if (file == NULL) file = stdout;
  }
  
  // Cycle through
  gadget = 16;
  flag = 1;
  
  for(row = 0; flag; row = row + 1) {

    *name   = 0;
    *layers = 0;
    
    FIfld_get_text(form, gadget, row, 0, 1024, name,   &sel, &pos);
    FIfld_get_text(form, gadget, row, 2, 1024, layers, &sel, &pos);

    if ((*name == 0) && (*layers == 0)) flag = 0;
    else {
      fprintf(file,"%s=%s\n",name,layers);
    }  
  }
  
  if (file != stdout) fclose(file);
  UI_status("Done");
  
wrapup:
  return;
}


